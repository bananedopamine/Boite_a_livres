{# @author : Dufour Marc (marc.dufour@stjosup.com)
 # @version : 1
 # @dateCreate : 12/01/2026
 # @lastUpdate : 12/01/2026
 #}

{% extends 'base.html.twig' %}

{% block body %}
<div class="container">
    <form action="{{ path('app_mouvement_verification') }}" method="post">
        <div class="mb-3">
            <label class="form-label">Type de mouvement :</label>
            <select name="type_action" class="form-select">
                <option value="false" {{ selection_defaut == 'false' ? 'selected' : '' }} > ENTRÉE (Retour de livre)</option>
                <option value="true"  {{ selection_defaut == 'true'  ? 'selected' : '' }} > SORTIE (Emprunt de livre)</option>
            </select>
        </div>

        <div class="mb-3">
            <label class="form-label">Scanner ou entrer l'ISBN :</label>
            {# On ajoute un ID à l'input pour le cibler facilement #}
            <input type="text" name="isbn" id="isbnInput" class="form-control" required autofocus>
        </div>

        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary">Vérifier en base</button>
            
            {# Le bouton Google avec une fonction au clic #}
            <button type="button" class="btn btn-info" onclick="checkGoogle()">
                Vérifier sur Google
            </button>
        </div>

        {# <button type="submit" class="btn btn-primary">Vérifier</button> #}
    </form>
</div>

<script>
function checkGoogle() {
    const isbn = document.getElementById('isbnInput').value;
    if (isbn.trim() === "") {
        alert("Veuillez saisir un ISBN avant de vérifier sur Google.");
        return;
    }

    const baseUrl = "{{ path('app_livre_google_check', {'isbn': 'REPLACE_ME'}) }}";
    window.location.href = baseUrl.replace('REPLACE_ME', isbn);
}
</script>
{% endblock %}